{% extends "base.html" %}

{% block title %}Panier – Resto{% endblock %}

{% block content %}
<h1 class="h3 mb-4">Votre panier</h1>

{% if cart %}
  <table class="table align-middle">
    <thead>
      <tr>
        <th>Plat</th>
        <th>Qté</th>
        <th>Total</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for item in cart %}
        <tr>
          <td>{{ item.meal.name }}</td>
          <td>{{ item.quantity }}</td>
          <td>{{ item.total_price }} FCFA</td>
          <td>
            <a href="{% url 'shop:cart_remove' item.meal.id %}"
               class="btn btn-sm btn-outline-danger">
              Retirer
            </a>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <div class="d-flex justify-content-between align-items-center">
    <h4>Total : {{ cart.get_total_price }} FCFA</h4>

    {% if user.is_authenticated %}
      <a href="{% url 'shop:checkout' %}" class="btn btn-success">
        Passer la commande
      </a>
    {% else %}
      <div class="text-end">
        <p class="mb-1">Connectez-vous pour finaliser la commande.</p>
        <a href="{% url 'login' %}?next={% url 'shop:checkout' %}" class="btn btn-primary btn-sm">
          Connexion
        </a>
        <a href="{% url 'signup' %}?next={% url 'shop:checkout' %}" class="btn btn-outline-secondary btn-sm">
          Inscription
        </a>
      </div>
    {% endif %}
  </div>
{% else %}
  <p>Votre panier est vide.</p>
  <a href="{% url 'shop:meal_list' %}" class="btn btn-primary">Voir le menu</a>
{% endif %}

{% endblock %}
